#!/usr/bin/env python3

import argparse
import random

FILE = "words_list.txt"
password_lst = []
symbols = "~!@#$%^&*.:;"

# Parse the arguments
parser = argparse.ArgumentParser(description="Generate a secure, memorable password using the XKCD method")
parser.add_argument("-w", "--words", help="include WORDS words in the password (default=4)", type=int, default=4)
parser.add_argument("-c", "--caps", help="capitalize the first letter of CAPS random words (default=0). If CAPS exceeds WORDS, every word is capitalized", type=int, default=0)
parser.add_argument("-n", "--numbers", help="insert NUMBERS random numbers in the password (default=0)", type=int, default=0)
parser.add_argument("-s", "--symbols", help="insert SYMBOLS random symbols in the password (default=0)", type=int, default=0)
args = parser.parse_args()

# getting the lines from file
words_list = list(open(FILE))
words_list = [x.strip().lower() for x in words_list]

# WORDS
for i in range(args.words):
	password_lst.append(random.choice(words_list))

# CAPS
capitalized_already = [] 
if (args.caps > args.words):
	args.caps = args.words # to prevent an infinite loop
for i in range(args.caps):
	pos = random.randint(0, len(password_lst) - 1)
	
	# if the same index is chosen, choose another index
	while pos in capitalized_already:
		pos = random.randint(0, len(password_lst) - 1)	
	capitalized_already.append(pos) 
			
	password_lst[pos] = password_lst[pos].capitalize()

# NUMBERS
# Add numbers to front of strings. Append empty string to add to end of list.	
password_lst.append('')
for i in range(args.numbers):
	pos = random.randint(0, len(password_lst) - 1) 
	rand_num = random.randint(0, 9)
	password_lst[pos] = str(rand_num) + password_lst[pos] 

# SYMBOLS
for i in range(args.symbols):                                                  
        pos = random.randint(0, len(password_lst) - 1)                         
        rand_sym = random.randint(0, len(symbols) - 1)                         
        password_lst[pos] = symbols[rand_sym] + password_lst[pos]          
	
# Putting the password together
password = ''.join(password_lst)
print(password)
